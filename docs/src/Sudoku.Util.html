<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
Copyright (c) 2022, Frederick Pringle
All rights reserved.

This source code is licensed under the BSD-style license found in the
LICENSE file in the root directory of this source tree.
-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">-- | A collection of utility functions for working</span><span>
</span><span id="line-10"></span><span class="hs-comment">--   with Sudoku grids.</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Sudoku.Util</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><span class="hs-comment">{- * Printing Sudoku grids
  -}</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Sudoku.Util.html#showSudoku"><span class="hs-identifier">showSudoku</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sudoku.Util.html#showSudokuNice"><span class="hs-identifier">showSudokuNice</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sudoku.Util.html#printSudoku"><span class="hs-identifier">printSudoku</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sudoku.Util.html#printSudokuNice"><span class="hs-identifier">printSudokuNice</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-comment">{- * Parsing Sudoku grids
  -}</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sudoku.Util.html#parseSudoku"><span class="hs-identifier">parseSudoku</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sudoku.Util.html#readFromFile"><span class="hs-identifier">readFromFile</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-comment">-- , parseCSVLine</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sudoku.Util.html#readFromCSV"><span class="hs-identifier">readFromCSV</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Sudoku.Types.html"><span class="hs-identifier">Sudoku.Types</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | convert a grid to a simple string representation - blanks are represented as '.'</span><span>
</span><span id="line-36"></span><span class="annot"><a href="Sudoku.Util.html#showSudoku"><span class="hs-identifier hs-type">showSudoku</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-37"></span><span id="showSudoku"><span class="annot"><span class="annottext">showSudoku :: Sudoku -&gt; String
</span><a href="Sudoku.Util.html#showSudoku"><span class="hs-identifier hs-var hs-var">showSudoku</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Sudoku.Types.html#Grid"><span class="hs-identifier hs-type">Grid</span></a></span><span> </span><span id="local-6989586621679082209"><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679082209"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; String) -&gt; [[Int]] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; [Int] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679082206"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082206"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082206"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082206"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679082209"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | convert a grid to a pretty string representation</span><span>
</span><span id="line-40"></span><span class="annot"><a href="Sudoku.Util.html#showSudokuNice"><span class="hs-identifier hs-type">showSudokuNice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-41"></span><span id="showSudokuNice"><span class="annot"><span class="annottext">showSudokuNice :: Sudoku -&gt; String
</span><a href="Sudoku.Util.html#showSudokuNice"><span class="hs-identifier hs-var hs-var">showSudokuNice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Sudoku.Types.html#Grid"><span class="hs-identifier hs-type">Grid</span></a></span><span> </span><span id="local-6989586621679082204"><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679082204"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621679082203"><span class="annot"><span class="annottext">horz :: String
</span><a href="#local-6989586621679082203"><span class="hs-identifier hs-var hs-var">horz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;------+-------+------&quot;</span></span><span>
</span><span id="line-44"></span><span>    </span><span id="local-6989586621679082202"><span class="annot"><span class="annottext">_ls :: [[String]]
</span><a href="#local-6989586621679082202"><span class="hs-identifier hs-var hs-var">_ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [String]) -&gt; [[Int]] -&gt; [[String]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; [Int] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679082201"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082201"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082201"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082201"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679082204"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span id="local-6989586621679082200"><span class="annot"><span class="annottext">ls :: [String]
</span><a href="#local-6989586621679082200"><span class="hs-identifier hs-var hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679082197"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679082197"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679082197"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679082197"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679082197"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[String]]
</span><a href="#local-6989586621679082202"><span class="hs-identifier hs-var">_ls</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679082200"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082203"><span class="hs-identifier hs-var">horz</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679082200"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082203"><span class="hs-identifier hs-var">horz</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679082200"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | print a sudoku grid in its simple string representation - see 'showSudoku'</span><span>
</span><span id="line-50"></span><span class="annot"><a href="Sudoku.Util.html#printSudoku"><span class="hs-identifier hs-type">printSudoku</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span id="printSudoku"><span class="annot"><span class="annottext">printSudoku :: Sudoku -&gt; IO ()
</span><a href="Sudoku.Util.html#printSudoku"><span class="hs-identifier hs-var hs-var">printSudoku</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; (Sudoku -&gt; String) -&gt; Sudoku -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Sudoku -&gt; String
</span><a href="Sudoku.Util.html#showSudoku"><span class="hs-identifier hs-var">showSudoku</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | print a sudoku grid in its pretty string representation - see 'showSudokuNice'</span><span>
</span><span id="line-54"></span><span class="annot"><a href="Sudoku.Util.html#printSudokuNice"><span class="hs-identifier hs-type">printSudokuNice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span id="printSudokuNice"><span class="annot"><span class="annottext">printSudokuNice :: Sudoku -&gt; IO ()
</span><a href="Sudoku.Util.html#printSudokuNice"><span class="hs-identifier hs-var hs-var">printSudokuNice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; (Sudoku -&gt; String) -&gt; Sudoku -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Sudoku -&gt; String
</span><a href="Sudoku.Util.html#showSudokuNice"><span class="hs-identifier hs-var">showSudokuNice</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | parse a sudoku grid from a string</span><span>
</span><span id="line-58"></span><span class="annot"><a href="Sudoku.Util.html#parseSudoku"><span class="hs-identifier hs-type">parseSudoku</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span>
</span><span id="line-59"></span><span id="parseSudoku"><span class="annot"><span class="annottext">parseSudoku :: String -&gt; Sudoku
</span><a href="Sudoku.Util.html#parseSudoku"><span class="hs-identifier hs-var hs-var">parseSudoku</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Int]] -&gt; Sudoku
forall a. [[a]] -&gt; Grid a
</span><a href="Sudoku.Types.html#Grid"><span class="hs-identifier hs-var">Grid</span></a></span><span> </span><span class="annot"><span class="annottext">([[Int]] -&gt; Sudoku) -&gt; (String -&gt; [[Int]]) -&gt; String -&gt; Sudoku
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [Int]) -&gt; [String] -&gt; [[Int]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Int) -&gt; String -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679082192"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679082192"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679082192"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679082192"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [[Int]]) -&gt; (String -&gt; [String]) -&gt; String -&gt; [[Int]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | read a file and parse the sudoku grid</span><span>
</span><span id="line-62"></span><span class="annot"><a href="Sudoku.Util.html#readFromFile"><span class="hs-identifier hs-type">readFromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span>
</span><span id="line-63"></span><span id="readFromFile"><span class="annot"><span class="annottext">readFromFile :: String -&gt; IO Sudoku
</span><a href="Sudoku.Util.html#readFromFile"><span class="hs-identifier hs-var hs-var">readFromFile</span></a></span></span><span> </span><span id="local-6989586621679082188"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082188"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sudoku
</span><a href="Sudoku.Util.html#parseSudoku"><span class="hs-identifier hs-var">parseSudoku</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Sudoku) -&gt; IO String -&gt; IO Sudoku
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><span class="hs-identifier hs-var">readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082188"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | Parse a line of a CSV file in the format in</span><span>
</span><span id="line-66"></span><span class="hs-comment">--  [this kaggle dataset](https://www.kaggle.com/datasets/rohanrao/sudoku#:~:text=single%20unique%20solution.-,Content,-Each%20row%20represents)</span><span>
</span><span id="line-67"></span><span class="annot"><a href="Sudoku.Util.html#parseCSVLine"><span class="hs-identifier hs-type">parseCSVLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span id="parseCSVLine"><span class="annot"><span class="annottext">parseCSVLine :: String -&gt; (Sudoku, Sudoku)
</span><a href="Sudoku.Util.html#parseCSVLine"><span class="hs-identifier hs-var hs-var">parseCSVLine</span></a></span></span><span> </span><span id="local-6989586621679082184"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082184"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679082183"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082183"><span class="hs-identifier hs-var">puz</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679082182"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082182"><span class="hs-identifier hs-var">sol</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String]) -&gt; String -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679082180"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679082180"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679082180"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679082180"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082184"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Sudoku
</span><a href="#local-6989586621679082179"><span class="hs-identifier hs-var">parseCSVCol</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082183"><span class="hs-identifier hs-var">puz</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sudoku
</span><a href="#local-6989586621679082179"><span class="hs-identifier hs-var">parseCSVCol</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082182"><span class="hs-identifier hs-var">sol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="#local-6989586621679082179"><span class="hs-identifier hs-type">parseCSVCol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679082179"><span class="annot"><span class="annottext">parseCSVCol :: String -&gt; Sudoku
</span><a href="#local-6989586621679082179"><span class="hs-identifier hs-var hs-var">parseCSVCol</span></a></span></span><span> </span><span id="local-6989586621679082178"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082178"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; Grid (Int, Int) -&gt; Sudoku
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679082177"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082177"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679082176"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082176"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082178"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Char
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082177"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679082176"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Grid (Int, Int)
</span><a href="Sudoku.Types.html#allSquares"><span class="hs-identifier hs-var">allSquares</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Parse puzzles and solutions a CSV file in the format in</span><span>
</span><span id="line-76"></span><span class="hs-comment">--  [this kaggle dataset](https://www.kaggle.com/datasets/rohanrao/sudoku#:~:text=single%20unique%20solution.-,Content,-Each%20row%20represents)</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Sudoku.Util.html#readFromCSV"><span class="hs-identifier hs-type">readFromCSV</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sudoku.Types.html#Sudoku"><span class="hs-identifier hs-type">Sudoku</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span id="readFromCSV"><span class="annot"><span class="annottext">readFromCSV :: String -&gt; IO [(Sudoku, Sudoku)]
</span><a href="Sudoku.Util.html#readFromCSV"><span class="hs-identifier hs-var hs-var">readFromCSV</span></a></span></span><span> </span><span id="local-6989586621679082171"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082171"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Sudoku, Sudoku)) -&gt; [String] -&gt; [(Sudoku, Sudoku)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (Sudoku, Sudoku)
</span><a href="Sudoku.Util.html#parseCSVLine"><span class="hs-identifier hs-var">parseCSVLine</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [(Sudoku, Sudoku)])
-&gt; (String -&gt; [String]) -&gt; String -&gt; [(Sudoku, Sudoku)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; (String -&gt; [String]) -&gt; String -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [(Sudoku, Sudoku)])
-&gt; IO String -&gt; IO [(Sudoku, Sudoku)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><span class="hs-identifier hs-var">Strict.readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679082171"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-79"></span></pre></body></html>